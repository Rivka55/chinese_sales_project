<div class="gift-edit-card">
    <h3 class="form-title">{{ id > 0 ? 'âœï¸ ×¢×¨×™×›×ª ××ª× ×”' : 'â• ×”×•×¡×¤×ª ××ª× ×”' }}</h3>
    <div class="gift-form" [formGroup]="frmGift">

        @if (id > 0) {
        <div class="form-group">
            <label>ğŸ”¢ ××¡×¤×¨ ××ª× ×” (ID)</label>
            <input type="number" class="form-control" [value]="id" disabled />
        </div>
        }

        <div class="form-group">
            <label>ğŸ ×©× ××ª× ×”</label>
            <input type="text" class="form-control" formControlName="name" placeholder="×©× ×”××ª× ×”"
                [class.border-danger]="frmGift.controls['name'].invalid && frmGift.controls['name'].touched" />

            @if (frmGift.controls['name'].touched && frmGift.controls['name'].errors?.['required']) {
            <div class="text-danger">×©×“×” ×—×•×‘×”</div>
            }
            @if (frmGift.controls['name'].errors?.['maxlength']) {
            <div class="text-danger">×©× ××ª× ×” ×œ× ×™×›×•×œ ×œ×”×™×•×ª ××¨×•×š ×™×•×ª×¨ ×-50 ×ª×•×•×™×</div>
            }
            @if (frmGift.controls['name'].errors?.['existName']) {
            <div class="text-danger">{{ frmGift.controls['name'].errors?.['existName'] }}</div>
            }
        </div>

        <div class="form-group">
            <label>ğŸ“ ×ª×™××•×¨</label>
            <input type="text" class="form-control" formControlName="description" placeholder="×ª×™××•×¨ ×”××ª× ×”"
                [class.border-danger]="frmGift.controls['description'].invalid && frmGift.controls['description'].touched" />

            @if (frmGift.controls['description'].touched && frmGift.controls['description'].errors?.['required']) {
            <div class="text-danger">×©×“×” ×—×•×‘×”</div>
            }
        </div>

        <div class="form-group">
            <label>ğŸ–¼ï¸ ×ª××•× ×” (URL)</label>
            <input type="text" class="form-control" formControlName="picture" placeholder="×©× ×§×•×‘×¥ ×”×ª××•× ×”" dir="ltr"
                [class.border-danger]="frmGift.controls['picture'].invalid && frmGift.controls['picture'].touched" />

            @if (frmGift.controls['picture'].touched && frmGift.controls['picture'].errors?.['required']) {
            <div class="text-danger">×©×“×” ×—×•×‘×”</div>
            }

            @if (frmGift.get('picture')?.value) {
            <div class="preview-container">
                <p>×ª×¦×•×’×” ××§×“×™××”:</p>
                <img [src]="'images/' + frmGift.get('picture')?.value" 
                     class="gift-img-preview" 
                     (error)="handleImageError($event)"
                     style="max-width: 200px; border-radius: 8px; border: 1px solid #ddd;" />
            </div>
            }
        </div>

        <div class="form-group">
            <label>ğŸ’° ××—×™×¨ ×›×¨×˜×™×¡ ×‘×•×“×“</label>
            <input type="number" class="form-control" formControlName="price" dir="ltr"
                [class.border-danger]="frmGift.controls['price'].invalid && frmGift.controls['price'].touched" />

            @if (frmGift.controls['price'].errors?.['min']) {
            <div class="text-danger">××—×™×¨ ××™× ×™××•× 5 ×©"×—</div>
            }
        </div>

        <div class="form-group">
            <label>ğŸ¤ ×ª×•×¨×</label>
            <select class="form-control" formControlName="donor"
                [class.border-danger]="frmGift.controls['donor'].invalid && frmGift.controls['donor'].touched">
                <option [ngValue]="null" disabled>×‘×—×¨ ×ª×•×¨×</option>
                @for (d of donors; track d.id) {
                <option [ngValue]="d">{{ d.name }}</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label>ğŸ“‚ ×§×˜×’×•×¨×™×”</label>
            <select class="form-control" formControlName="category"
                [class.border-danger]="frmGift.controls['category'].invalid && frmGift.controls['category'].touched">
                <option [ngValue]="null" disabled>×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
                @for (c of categories; track c.id) {
                <option [ngValue]="c">{{ c.name }}</option>
                }
            </select>
        </div>

        <div class="btn-row">
            <button class="btn-save" (click)="saveGift()" [disabled]="frmGift.invalid">ğŸ’¾ ×©××•×¨</button>
            <button class="btn-cancel" (click)="cancelChanges()">×‘×™×˜×•×œ</button>
            @if (id > 0) {
            <button class="btn-delete" (click)="deleteGift(id)">ğŸ—‘ï¸ ××—×™×§×”</button>
            }
        </div>
    </div>
</div>