<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-icon">
        <svg width="56" height="56" viewBox="0 0 56 56" fill="none">
          <circle cx="28" cy="28" r="28" fill="url(#headerGrad)" />
          <path d="M28 16c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm0 20c-5.3 0-16 2.7-16 8v2h32v-2c0-5.3-10.7-8-16-8z" fill="#fff"/>
          <defs>
            <linearGradient id="headerGrad" x1="0" y1="0" x2="56" y2="56">
              <stop offset="0%" stop-color="#ff6b6b"/>
              <stop offset="50%" stop-color="#ffa502"/>
              <stop offset="100%" stop-color="#ffd93d"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h2>×”×¨×©××” ×œ××›×™×¨×” ×”×¡×™× ×™×ª</h2>
      <p class="auth-subtitle">×¦×•×¨ ×—×©×‘×•×Ÿ ×—×“×© ×•×”×¦×˜×¨×£ ×œ××›×™×¨×”</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="register()" novalidate>
      <!-- Name Field -->
      <div class="form-group" [class.has-error]="f['name'].touched && f['name'].invalid" [class.has-success]="f['name'].touched && f['name'].valid">
        <label for="name">
          <i class="field-icon">ğŸ‘¤</i>
          ×©× ××œ×
        </label>
        <div class="input-wrapper">
          <input
            type="text"
            id="name"
            formControlName="name"
            placeholder="×”×›× ×¡ ×©× ××œ×"
            autocomplete="name"
          />
          @if (f['name'].touched && f['name'].valid && !f['name'].pending) {
            <span class="status-icon valid">âœ“</span>
          }
          @if (f['name'].touched && f['name'].invalid) {
            <span class="status-icon invalid">âœ—</span>
          }
          @if (f['name'].pending) {
            <span class="status-icon checking">â³</span>
          }
        </div>
        @if (f['name'].touched && f['name'].errors) {
          <div class="error-messages">
            @if (f['name'].errors['required']) {
              <small>âš  ×©× ×”×•× ×©×“×” ×—×•×‘×”</small>
            }
            @if (f['name'].errors['minlength']) {
              <small>âš  ×©× ×—×™×™×‘ ×œ×”×›×™×œ ×œ×¤×—×•×ª 2 ×ª×•×•×™×</small>
            }
            @if (f['name'].errors['maxlength']) {
              <small>âš  ×©× ×œ× ×™×›×•×œ ×œ×”×›×™×œ ×™×•×ª×¨ ×-50 ×ª×•×•×™×</small>
            }
            @if (f['name'].errors['nameExists']) {
              <small>âš  ×©× ×”××©×ª××© ×›×‘×¨ ×§×™×™× ×‘××¢×¨×›×ª</small>
            }
          </div>
        }
        @if (f['name'].pending) {
          <div class="checking-hint">â³ ×‘×•×“×§ ×–××™× ×•×ª ×©× ××©×ª××©...</div>
        }
        @if (f['name'].touched && f['name'].valid && !f['name'].pending) {
          <div class="success-hint">âœ“ ×©× ×ª×§×™×Ÿ</div>
        }
      </div>

      <!-- Phone Field -->
      <div class="form-group" [class.has-error]="f['phone'].touched && f['phone'].invalid" [class.has-success]="f['phone'].touched && f['phone'].valid">
        <label for="phone">
          <i class="field-icon">ğŸ“±</i>
          ×˜×œ×¤×•×Ÿ
        </label>
        <div class="input-wrapper">
          <input
            type="tel"
            id="phone"
            formControlName="phone"
            placeholder="050-1234567"
            autocomplete="tel"
            dir="ltr"
          />
          @if (f['phone'].touched && f['phone'].valid) {
            <span class="status-icon valid">âœ“</span>
          }
          @if (f['phone'].touched && f['phone'].invalid) {
            <span class="status-icon invalid">âœ—</span>
          }
        </div>
        @if (f['phone'].touched && f['phone'].errors) {
          <div class="error-messages">
            @if (f['phone'].errors['required']) {
              <small>âš  ×˜×œ×¤×•×Ÿ ×”×•× ×©×“×” ×—×•×‘×”</small>
            }
            @if (f['phone'].errors['phonePrefix']) {
              <small>âš  ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×™×™×‘ ×œ×”×ª×—×™×œ ×‘-0 (×™×©×¨××œ×™) ××• + (×‘×™× ×œ××•××™)</small>
            }
            @if (f['phone'].errors['phoneChars']) {
              <small>âš  ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×™×›×•×œ ×œ×”×›×™×œ ×¨×§ ×¡×¤×¨×•×ª, ××§×¤×™× ×•×¨×•×•×—×™×</small>
            }
            @if (f['phone'].errors['phoneLength']) {
              <small>âš  ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×™×©×¨××œ×™ ×—×™×™×‘ ×œ×”×›×™×œ 9-10 ×¡×¤×¨×•×ª, ×‘×™× ×œ××•××™ 7-15 ×¡×¤×¨×•×ª</small>
            }
            @if (f['phone'].errors['phoneMobile']) {
              <small>âš  ××¡×¤×¨ × ×™×™×“ ×™×©×¨××œ×™ ×—×™×™×‘ ×œ×”×ª×—×™×œ ×‘-05</small>
            }
          </div>
        }
        @if (f['phone'].touched && f['phone'].valid) {
          <div class="success-hint">âœ“ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×ª×§×™×Ÿ</div>
        }
      </div>

      <!-- Email Field -->
      <div class="form-group" [class.has-error]="f['email'].touched && f['email'].invalid" [class.has-success]="f['email'].touched && f['email'].valid">
        <label for="email">
          <i class="field-icon">ğŸ“§</i>
          ××™××™×™×œ
        </label>
        <div class="input-wrapper">
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="example@email.com"
            autocomplete="email"
            dir="ltr"
          />
          @if (f['email'].touched && f['email'].valid && !f['email'].pending) {
            <span class="status-icon valid">âœ“</span>
          }
          @if (f['email'].touched && f['email'].invalid) {
            <span class="status-icon invalid">âœ—</span>
          }
          @if (f['email'].pending) {
            <span class="status-icon checking">â³</span>
          }
        </div>
        @if (f['email'].touched && f['email'].errors) {
          <div class="error-messages">
            @if (f['email'].errors['required']) {
              <small>âš  ××™××™×™×œ ×”×•× ×©×“×” ×—×•×‘×”</small>
            }
            @if (f['email'].errors['emailNoAt']) {
              <small>âš  ×›×ª×•×‘×ª ××™××™×™×œ ×—×™×™×‘×ª ×œ×”×›×™×œ ×¡×™××Ÿ @</small>
            }
            @if (f['email'].errors['emailMultiAt']) {
              <small>âš  ×›×ª×•×‘×ª ××™××™×™×œ ×™×›×•×œ×” ×œ×”×›×™×œ ×¡×™××Ÿ @ ××—×“ ×‘×œ×‘×“</small>
            }
            @if (f['email'].errors['emailNoLocal']) {
              <small>âš  ×—×¡×¨ ×©× ××©×ª××© ×œ×¤× ×™ ×”-@</small>
            }
            @if (f['email'].errors['emailNoDomain']) {
              <small>âš  ×—×¡×¨ ×“×•××™×™×Ÿ (×œ×“×•×’××”: gmail.com)</small>
            }
            @if (f['email'].errors['emailBadDomain']) {
              <small>âš  ×“×•××™×™×Ÿ ×œ× ×ª×§×™×Ÿ - ×œ× ×™×›×•×œ ×œ×”×ª×—×™×œ ××• ×œ×”×¡×ª×™×™× ×‘× ×§×•×“×”</small>
            }
            @if (f['email'].errors['emailInvalid']) {
              <small>âš  ×›×ª×•×‘×ª ××™××™×™×œ ×œ× ×ª×§×™× ×” (×œ×“×•×’××”: name&#64;domain.com)</small>
            }
            @if (f['email'].errors['emailExists']) {
              <small>âš  ×›×ª×•×‘×ª ×”××™××™×™×œ ×›×‘×¨ ×¨×©×•××” ×‘××¢×¨×›×ª</small>
            }
          </div>
        }
        @if (f['email'].pending) {
          <div class="checking-hint">â³ ×‘×•×“×§ ×–××™× ×•×ª ××™××™×™×œ...</div>
        }
        @if (f['email'].touched && f['email'].valid && !f['email'].pending) {
          <div class="success-hint">âœ“ ××™××™×™×œ ×ª×§×™×Ÿ</div>
        }
      </div>

      <!-- Password Field -->
      <div class="form-group" [class.has-error]="f['password'].touched && f['password'].invalid" [class.has-success]="f['password'].touched && f['password'].valid">
        <label for="password">
          <i class="field-icon">ğŸ”’</i>
          ×¡×™×¡××”
        </label>
        <div class="input-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            placeholder="×œ×¤×—×•×ª 6 ×ª×•×•×™×"
            autocomplete="new-password"
            dir="ltr"
          />
          <button type="button" class="toggle-password" (click)="togglePassword()" tabindex="-1">
            {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
          </button>
        </div>
        @if (f['password'].touched && f['password'].errors) {
          <div class="error-messages">
            @if (f['password'].errors['required']) {
              <small>âš  ×¡×™×¡××” ×”×™× ×©×“×” ×—×•×‘×”</small>
            }
            @if (f['password'].errors['minlength']) {
              <small>âš  ×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×™×•×ª ×œ×¤×—×•×ª 6 ×ª×•×•×™× ({{ f['password'].value.length }}/6)</small>
            }
            @if (f['password'].errors['maxlength']) {
              <small>âš  ×¡×™×¡××” ×œ× ×™×›×•×œ×” ×œ×”×›×™×œ ×™×•×ª×¨ ×-100 ×ª×•×•×™×</small>
            }
          </div>
        }
        <!-- Password Strength Indicator -->
        @if (f['password'].value) {
          <div class="password-strength">
            <div class="strength-bar">
              <div
                class="strength-fill"
                [style.width]="getPasswordStrengthPercent()"
                [ngClass]="getPasswordStrengthClass()"
              ></div>
            </div>
            <small class="strength-label" [ngClass]="getPasswordStrengthClass()">
              {{ getPasswordStrengthText() }}
            </small>
          </div>
          <div class="password-tips">
            <small [class.met]="f['password'].value.length >= 6">â€¢ ×œ×¤×—×•×ª 6 ×ª×•×•×™×</small>
            <small [class.met]="f['password'].value.length >= 10">â€¢ 10+ ×ª×•×•×™× ×œ×—×•×–×§ × ×•×¡×£</small>
            <small [class.met]="getPasswordStrength() >= 3">â€¢ ××•×ª ×’×“×•×œ×” ×‘×× ×’×œ×™×ª</small>
            <small [class.met]="getPasswordStrength() >= 4">â€¢ ×¡×¤×¨×” ××• ×ª×• ××™×•×—×“</small>
          </div>
        }
      </div>

      <!-- Error / Success Messages -->
      @if (errorMsg) {
        <div class="alert alert-error">
          <span class="alert-icon">âš ï¸</span>
          <span>{{ errorMsg }}</span>
        </div>
      }
      @if (successMsg) {
        <div class="alert alert-success">
          <span class="alert-icon">ğŸ‰</span>
          <span>{{ successMsg }}</span>
        </div>
      }

      <!-- Submit Button -->
      <button
        type="submit"
        class="btn-submit"
        [disabled]="isSubmitting"
        [class.loading]="isSubmitting"
      >
        @if (isSubmitting) {
          <span class="spinner"></span>
          × ×¨×©×...
        } @else {
          <span>×¦×•×¨ ×—×©×‘×•×Ÿ</span>
          <span class="btn-arrow">â†</span>
        }
      </button>

      <div class="auth-footer">
        <span>×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?</span>
        <a routerLink="/login">×”×™×›× ×¡ ×›××Ÿ</a>
      </div>
    </form>
  </div>
</div>